{% extends 'web/base.html' %}
{% load formatos %}
{% load static %}

{% block title %}Tienda{% endblock %}

{% block content %}

<div class="lux-store-header text-center mb-4">
  <h1 class="lux-title mb-1">Productos Disponibles</h1>
  <p class="lux-subtitle mb-0">Selección premium para tu cuidado y estilo.</p>
</div>

<div class="productos-container">
  {% for p in productos %}
  <article class="producto-card">
    <div class="producto-media">
      <img src="{% static 'images/' %}{{ p.imagen }}" alt="{{ p.nombre }}">
      <div class="producto-glow"></div>

      {% if p.stock <= 0 %}
        <div class="lux-chip lux-chip-bad">Agotado</div>
      {% else %}
        <div class="lux-chip lux-chip-ok">En stock</div>
      {% endif %}
    </div>

    <div class="producto-info">
      <h3 class="producto-title">{{ p.nombre }}</h3>

      <div class="precio">${{ p.precio|precio_cl }}</div>

      {% if p.stock <= 0 %}
        <span class="btn-lux btn-lux-disabled w-100" aria-disabled="true">No disponible</span>
      {% else %}
        {% if user.is_authenticated %}
          <a href="{% url 'compra' p.id %}" class="btn-lux btn-lux-gold w-100">Comprar</a>
        {% else %}
          <a href="{% url 'login' %}?next=/compra/{{ p.id }}/" class="btn-lux btn-lux-outline w-100">
            Inicia sesión para comprar
          </a>
        {% endif %}
      {% endif %}

      <div class="lux-mini mt-3">Pago seguro • Entrega rápida</div>
    </div>
  </article>
  {% endfor %}
</div>

<style>
/* ====== TIENDA LUX (NEGRO / DORADO) ====== */
.lux-title{
  color:#f5f5f7;
  font-weight:900;
  letter-spacing:.2px;
}
.lux-subtitle{
  color:rgba(245,245,247,.72);
}

.productos-container{
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 16px;
}

.producto-card{
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 20px;
  overflow:hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.45);
  transition: transform .18s ease, border-color .18s ease, background .18s ease;
}
.producto-card:hover{
  transform: translateY(-3px);
  border-color: rgba(212,175,55,.35);
  background: rgba(255,255,255,0.06);
}

.producto-media{
  position:relative;
  height: 260px;
  background:#0b0c10;
}
.producto-media img{
  width:100%;
  height:100%;
  object-fit: cover;
  filter: contrast(1.02) saturate(1.02);
}
.producto-glow{
  position:absolute;
  inset:0;
  background:
    radial-gradient(520px 260px at 0% 0%, rgba(212,175,55,0.18), transparent 60%),
    linear-gradient(180deg, rgba(0,0,0,0.05), rgba(0,0,0,0.55));
  pointer-events:none;
}

.lux-chip{
  position:absolute;
  top: 12px;
  left: 12px;
  padding: 7px 12px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 900;
  letter-spacing:.2px;
  border: 1px solid rgba(255,255,255,0.12);
  backdrop-filter: blur(6px);
}
.lux-chip-ok{
  color:#b8ffca;
  background: rgba(34,197,94,0.14);
  border-color: rgba(34,197,94,0.22);
}
.lux-chip-bad{
  color:#ffb4b4;
  background: rgba(239,68,68,0.14);
  border-color: rgba(239,68,68,0.22);
}

.producto-info{
  padding: 14px 16px 16px 16px;
  text-align:center;
}
.producto-title{
  margin:0;
  color:#f5f5f7;
  font-weight:900;
  font-size: 16px;
  line-height:1.2;
  min-height: 38px;
}

.precio{
  margin: 10px 0 12px 0;
  font-weight: 900;
  font-size: 18px;
  color: #f3d36b;
  letter-spacing:.2px;
}

.btn-lux{
  display:inline-flex;
  justify-content:center;
  align-items:center;
  gap:8px;
  padding: 10px 14px;
  border-radius: 14px;
  font-weight: 900;
  text-decoration:none;
  border:1px solid rgba(255,255,255,0.12);
  transition: transform .18s ease, filter .18s ease, background .18s ease, border-color .18s ease;
}
.btn-lux:hover{ transform: translateY(-1px); }

.btn-lux-gold{
  color:#0b0c10;
  background: linear-gradient(90deg, #d4af37, #f3d36b);
  border-color: rgba(212,175,55,.55);
}
.btn-lux-gold:hover{ filter: brightness(1.05); }

.btn-lux-outline{
  color:#f3d36b;
  background: rgba(212,175,55,0.08);
  border-color: rgba(212,175,55,0.28);
}
.btn-lux-outline:hover{
  background: rgba(212,175,55,0.12);
  filter: brightness(1.03);
}

.btn-lux-disabled{
  color: rgba(245,245,247,.55);
  background: rgba(255,255,255,0.06);
  border-color: rgba(255,255,255,0.10);
  cursor:not-allowed;
}

.lux-mini{
  font-size: 12px;
  color: rgba(245,245,247,.65);
}

/* responsive */
@media (max-width: 1200px){
  .productos-container{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
}
@media (max-width: 576px){
  .productos-container{ grid-template-columns: 1fr; }
  .producto-media{ height: 220px; }
}
</style>

{% endblock %}
